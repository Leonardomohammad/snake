<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="style.css">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>snake</title>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  
<script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>


<!-- <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script> -->
</head>

<body>
    <h1 style="text-align:center;">This is a Game</h1>
    <div id="exit"></div>
    <div id="root"></div>
  <script type='text/babel' >
    
class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      stop:false,
      number:4,
      leaderId:29,
      preX:[39],
      fun:'moving',
      a: 1,
      apple:false,
      speed:500,
      array: [
        { id: 1, color: "pink", status: false },
        { id: 2, color: "black", status: false },
        { id: 3, color: "black", status: false },
        { id: 4, color: "black", status: false },
        { id: 5, color: "black", status: false },
        { id: 6, color: "black", status: false },
        { id: 7, color: "black", status: false },
        { id: 8, color: "black", status: false },
        { id: 9, color: "black", status: false },
        { id: 10, color: "black", status: false },
        { id: 11, color: "black", status: false },
        { id: 12, color: "black", status: false },
        { id: 13, color: "red", status: 3 },
        { id: 14, color: "red", status: 2},
        { id: 15, color: "red", status: 1 },
        { id: 16, color: "red", status: 'leader' },
        { id: 17, color: "black", status: false },
        { id: 18, color: "black", status: false },
        { id: 19, color: "black", status: false },
        { id: 20, color: "black", status: false },
        { id: 21, color: "black", status: false },
        { id: 22, color: "black", status: false },
        { id: 23, color: "black", status: false },
        { id: 24, color: "black", status: false },
        { id: 25, color: "black", status: false },
        { id: 26, color: "black", status: false },
        { id: 27, color: "black", status: false },
        { id: 28, color: "black", status: false },
        { id: 29, color: "black", status: false },
        { id: 30, color: "black", status: false }
      ]
    
    };
    // this.moving=this.moving.bind(this);
  }
 shouldComponentUpdate(nextProps, nextState){
  if(this.state.fun!=nextState.fun){
    console.log(this.state.fun,nextState.fun,'this.nextState.fun');
    return false;
  }
   if(this.state.leaderId!=nextState.leaderId){
    // console.log(this.state.leaderId,nextState.leaderId,'nextState.leaderId&&&&&&&&&&&&&&&&&&&&&***********')
    console.log(nextState.leaderId,'shouldComponentUpdate leaderId &&&&&&&&')
    return false;
  }
  if(this.state.array!=nextState.array&&this.state.apple!=nextState.apple){
    return false;
  }
  if(this.state.array!=nextState.array&&this.state.number!=nextState.number){
    return false;
  }
  // else if(this.state.stop!=nextState.stop){
  //   return false;
  // }
  return true;
 }
 
  componentDidMount() {
    document.addEventListener("keydown", this.key);
  }
  componentWillUnmount() {
    document.removeEventListener("keydown",this.key);
  }
  key = (e) => {
    let x = e.keyCode;
 console.log(x)
 let ne=this.state.preX;
if(x==38&&this.state.preX[this.state.preX.length-1]!==38&&this.state.preX[this.state.preX.length-1]!==40){
  console.log(ne,'beforeeeeee')
  ne=[...ne,38];
  console.log(ne,'afterrrr');

this.setState({
  preX:ne,
  fun:'up',
})
}
else if(x==39&&this.state.preX[this.state.preX.length-1]!==39&&this.state.preX[this.state.preX.length-1]!==37){
  ne=[...ne,39];
this.setState({
  preX:ne,
  fun:'moving',
})
}
else if(x==40&&this.state.preX[this.state.preX.length-1]!==40&&this.state.preX[this.state.preX.length-1]!==38){
  ne=[...ne,40];
this.setState({
  preX:ne,
  fun:'down',
})
}
else if(x==37&&this.state.preX[this.state.preX.length-1]!==37&&this.state.preX[this.state.preX.length-1]!==39){
  ne=[...ne,37];
this.setState({
  preX:ne,
  fun:'left',
})
}
else if(x===27){
  if(this.state.stop===true){
    this.setState({
      stop:false,
    })
  }
  else{
    this.setState({
      stop:true,
    })
  }
}
};


// leading= (mm) =>{
//   let newM=[...mm];
//   // console.log(newM,'here is me i am the newMmmmmm',newM[10].color)
//   for(let i=1;i<this.state.number;i++){
//   for(let y=0;y<newM.length;y++){
// // console.log('we are looping here')
//   if(newM[y].status=='L'+i){
//     console.log('catch youu',this.state.leaderId,y);
//     newM[y].color='black';
//     newM[this.state.leaderId].color='red';
//     newM[y].status=false;
//     newM[this.state.leaderId].status='L'+i;
//     this.setState({
//       leaderId:y,
//     })
//   }
// }
//   }
// // console.log('here is the new mmmmmmmmmmmmmmmmm',newM)
// return newM;

// }
adding=()=>{
 let m=[...this.state.array];
 if(this.state.fun=='moving'){
  let x=0;
for(let i=0;i<m.length&&x==0;i++){
  if(m[i].status==this.state.number-1){
if(i==0){
  m[29].color='red';
  m[29].status=this.state.number;
}
else{
  m[i-1].color='red';
  m[i-1].status=this.state.number;
}
  x=1;}
}
 }
  this.setState({
    number:this.state.number+1,
    array:m,
  })
}
moving =()=>{
    let m=[...this.state.array];
    let innerId=this.state.leaderId;
    // console.log('in the moving',m,this.state.array);
    let x=0;
          for(let i=0;i<m.length&&x==0;i++){
            if(i==29&&m[i].status==='leader'){
              if(m[0].color=='pink'){
                this.adding();
                this.eating();
              }
              m[i].color='black';
              m[0].color='red';
              m[0].status='leader';
              m[i].status=false;

              innerId=i;
              x=1;
            }
            else if(m[i].status==='leader'){
              if(m[i+1].color=='pink'){
                this.adding();
                this.eating();
              }
               m[i].color='black';
              m[i].status=false;
              m[i+1].color='red';
              m[i+1].status='leader';
              
              
              innerId=i;
              console.log(this.state.leaderId,'here is it after before')
              
              x=1;
            }}
    let final=0;
    for(let i=1;i<this.state.number;i++){
      final=0;
  for(let y=0;y<m.length&&final==0;y++){
// console.log('we are looping here')
  if(m[y].status==i){
    console.log('catch youu',this.state.leaderId,y,i);
    m[y].color='black';
    m[innerId].color='red';
    m[y].status=false;
    m[innerId].status=i;
    if(i<this.state.number-1){
innerId=y;
    }
    else if(i==this.state.number-1&&innerId!=y ){
    this.setState({
      leaderId:y,
      })
    }
final=1;
  }
}
  }

      setTimeout(()=>{
          let ne=0;
          if(this.state.preX.length>1){
            
         console.log(this.state.preX,'this.state.preX.shift()');
         ne=this.state.preX;
         ne.shift();
         console.log(ne,'this.state.preX.shift()');
        }
        else{ ne=this.state.preX;
        }
            this.setState((state,props)=>{
              return({
                preX:[...ne],
                array:m,

            })
          })
          }
          ,this.state.speed);
       
    
  };
 up=()=>{
  console.log('in the up');
  let m=[...this.state.array];

  let innerId=this.state.leaderId;
    let x=0;
          for(let i=0;i<m.length&&x==0;i++){
           if(i==4&&m[i].status==='leader'){
m[i].color='black';
m[i+21].color='red';
m[i].status=false;
m[i+21].status='leader';
// this.setState({
//   leaderId:i
// });
innerId=i;
x=1;
           }
           
           else if(i<5&&m[i].status==='leader'){
              m[i].color='black';
              m[i+26].color='red';
              m[i].status=false;
m[i+26].status='leader';
// this.setState({
//   leaderId:i
// });

innerId=i;
              x=1;
            }
            else if(m[i].status==='leader'){
               m[i].color='black';
             
              m[i-5].color='red';
              m[i].status=false;
m[i-5].status='leader';
// this.setState({
//   leaderId:i
// });

innerId=i;
              x=1;
            }}
      //  m=this.leading(m);
      let final=0;
    for(let i=1;i<this.state.number;i++){
      final=0;
  for(let y=0;y<m.length&&final==0;y++){
// console.log('we are looping here')
  if(m[y].status==i){
    console.log('catch youu',this.state.leaderId,y,i);
    m[y].color='black';
    m[innerId].color='red';
    m[y].status=false;
    m[innerId].status=i;
    if(i<this.state.number-1){
innerId=y;
    }
    else if(i==this.state.number-1&&innerId!=y ){
    this.setState({
      leaderId:y,
      })
    }
final=1;
  }
}
  }
console.log(m,'here is the end mmmmmm');
        
            setTimeout(()=>{
        let ne=0;
          if(this.state.preX.length>1){
         ne=this.state.preX;
        ne.shift();}
        else{
          ne=this.state.preX;
        }
            this.setState((state,props)=>{
              return({
                preX:ne,
                array:m,
            })
          })
          }
          ,this.state.speed);
    
    
  }
 
  down=()=>{
  console.log('in the down');
  let m=[...this.state.array];
let innerId=this.state.leaderId;
    let x=0;
          for(let i=0;i<m.length&&x==0;i++){
           if(i==4&&m[i].status==='leader'){
m[i].color='black';
m[0].color='red';
m[i].status=false;
m[0].status='leader';
innerId=i;
x=1;
           }
           
           else if(i>24&&m[i].status==='leader'){
              m[i].color='black';
              m[i-24].color='red';
              
m[i].status=false;
m[i-24].status='leader';
innerId=i;
              x=1;
            }
            else if(m[i].status=='leader'){
               m[i].color='black';
             
              m[i+5].color='red';
              
m[i].status=false;
m[i+5].status='leader';
innerId=i;
              x=1;

            }}

      let final=0;
    for(let i=1;i<this.state.number;i++){
      final=0;
  for(let y=0;y<m.length&&final==0;y++){
  if(m[y].status==i){
    console.log('catch youu',this.state.leaderId,y,i);
    m[y].color='black';
    m[innerId].color='red';
    m[y].status=false;
    m[innerId].status=i;
    if(i<this.state.number-1){
innerId=y;
    }
    else if(i==this.state.number-1&&innerId!=y ){
    this.setState({
      leaderId:y,
      })
    }
final=1;
  }
}
  }
console.log(m,'here is the end mmmmmm');
     
       setTimeout(()=>{
          let ne=0;
          if(this.state.preX.length>1){
         ne=this.state.preX;
        ne.shift();}
        else{
          ne=this.state.preX;
        }
            this.setState((state,props)=>{
              return({
                array:m,
                preX:ne,
            })
          })
          }
          ,this.state.speed);
    
    
  
 }
  left=()=>{
    let m=[...this.state.array];
    let innerId=this.state.leaderId;
  console.log('in the left');
    let x=0;
          for(let i=0;i<m.length&&x==0;i++){
           if(i==0&&m[i].status==='leader'){
m[i].color='black';
m[29].color='red';

m[29].status='leader';
              m[i].status=false;
              innerId=i;
x=1;
           }
           
            else if(m[i].status==='leader'){
               m[i].color='black';
              m[i-1].color='red';
              
              m[i-1].status='leader';
              m[i].status=false;
              
innerId=i;
              x=1;
            }}
            let final=0;
    for(let i=1;i<this.state.number;i++){
      final=0;
  for(let y=0;y<m.length&&final==0;y++){
  if(m[y].status==i){
    console.log('catch youu',this.state.leaderId,y,i);
    m[y].color='black';
    m[innerId].color='red';
    m[y].status=false;
    m[innerId].status=i;
    if(i<this.state.number-1){
innerId=y;
    }
    else if(i==this.state.number-1&&innerId!=y ){
    this.setState({
      leaderId:y,
      })
    }
final=1;
  }
}
  }
console.log(m,'here is the end mmmmmm');
          
        setTimeout(()=>{
          let ne=0;
          if(this.state.preX.length>1){
         ne=this.state.preX;
        ne.shift();}
        else{
          ne=this.state.preX;
        }
            this.setState((state,props)=>{
              return({
                array:m,
                preX:ne,
            })
          })
          }
          ,this.state.speed);
    
    
  }
  
  stopp=()=>{
let m=[...this.state.array];

  }
  eating=()=>{
    let m=[...this.state.array];
    let x=Math.round(Math.random()*30);
    
    console.log(m,x,'here is x and m')
    let newArray=[];
    while(m[x].color=='red'){
      x=Math.round(Math.random*30);
    }
    m[x].color='pink';
    if(this.state.apple==true){
this.setState({
  array:m,
  apple:false,
})}
else{
  this.setState({
  array:m,
  apple:true,
}) 
}
  
}
  
  render() {
    // console.log('hello this is 1111',this.state.array)
  if(this.state.stop===true){
    // console.log(this.state.stop,'here we go')
this.stopp();
  }
  else{
   if(this.state.preX[0]==39){
   this.moving();
    }
    
  else  if(this.state.preX[0]==38){
this.up();
}
  else if(this.state.preX[0]==40){
    this.down();
  }
  else if(this.state.preX[0]==37){
    this.left();
  }
  }
return(
      <div className="main">
        {this.state.array.map((a) => {
          return <Mm style={{ backgroundColor: a.color }} id={a.id} />;
        })}
      </div>
    );
  }

}

class Mm extends React.Component {
  constructor(props) {
    super(props);
  }
  render() {
    return (
      <div className="unit" style={this.props.style} id={this.props.id}></div>
    );
  }
}
ReactDOM.render(<App />, document.getElementById("root"));
      class X extends React.Component{
render(){

  return(
    <button onClick='handleClick'>exit</button>
  )
}
      }  
        
        ReactDOM.render(<X />,document.getElementById('exit'));
        </script>
</body>
</html>